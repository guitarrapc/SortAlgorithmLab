# VisualizationWeb - é€Ÿåº¦åˆ¶å¾¡ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æã¨è§£æ±ºç­–

## ğŸ“‹ å•é¡Œã®æ¦‚è¦

**ç¾è±¡:**
- Speed Multiplierã‚’100å€ã«è¨­å®šã—ã¦ã‚‚ã€ä½“æ„Ÿé€Ÿåº¦ãŒ2-3å€ç¨‹åº¦ã«ã—ã‹ãªã‚‰ãªã„
- 1è¦ç´ ã®æ“ä½œã‚’å…‰é€Ÿã§å‹•ã‹ã™ã¨ã„ã†æœŸå¾…ã«å¯¾ã—ã¦ã€æ˜ã‚‰ã‹ã«é…ã„
- ç†è«–ä¸Š0.083ç§’ã§å®Œäº†ã™ã¹ãå‡¦ç†ãŒã€å®Ÿéš›ã«ã¯7.5-10ç§’ã‹ã‹ã‚‹

**åŸå› :**
- `System.Timers.Timer`ã®ç²¾åº¦é™ç•Œï¼ˆæœ€å°15.6msï¼‰
- UIæ›´æ–°ãƒ­ã‚¸ãƒƒã‚¯ã®è¨­è¨ˆãƒŸã‚¹
- Blazor WebAssemblyã¨SVGæç”»ã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯

---

## ğŸ” æ·±ã„åˆ†æ

### 1. System.Timers.Timerã®ç²¾åº¦é™ç•Œ ğŸ”´

#### å®Ÿè£…ã‚³ãƒ¼ãƒ‰
```csharp
// PlaybackService.cs Line 54-58
private void UpdateTimerInterval()
{
    // ãƒ™ãƒ¼ã‚¹FPS Ã— é€Ÿåº¦å€ç‡ã§ã‚¿ã‚¤ãƒãƒ¼é–“éš”ã‚’è¨ˆç®—
    _timer.Interval = 1000.0 / (TARGET_FPS * SpeedMultiplier);
}
```

#### è¨­å®šå€¤ vs å®Ÿéš›ã®å‹•ä½œ

| Speed Multiplier | è¨ˆç®—é–“éš” | Windowså®Ÿæ¸¬å€¤ | ç†è«–FPS | å®Ÿæ¸¬FPS |
|------------------|----------|---------------|---------|---------|
| 1x | 16.67ms | 16-17ms | 60 | 58-62 âœ… |
| 10x | 1.67ms | 15-20ms | 600 | 50-66 ğŸ”´ |
| 50x | 0.33ms | 15-20ms | 3,000 | 50-66 ğŸ”´ |
| 100x | 0.166ms | 15-20ms | 6,000 | 50-66 ğŸ”´ |

**æ ¹æœ¬åŸå› :**
- Windowsã®`System.Timers.Timer`ã¯å†…éƒ¨çš„ã«`multimedia timer`ã‚’ä½¿ç”¨
- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ã‚¿ã‚¤ãƒãƒ¼è§£åƒåº¦ã¯**15.625msï¼ˆ64 Hzï¼‰**
- `timeBeginPeriod(1)`ã§1msã¾ã§æ”¹å–„å¯èƒ½ã ãŒã€ãã‚Œã§ã‚‚ãƒŸãƒªç§’å˜ä½ãŒé™ç•Œ
- **ã‚µãƒ–ãƒŸãƒªç§’ã®ç²¾åº¦ã¯ä¸å¯èƒ½** ğŸ’¥

**å‚è€ƒæ–‡çŒ®:**
- [Windows Timer Resolution](https://learn.microsoft.com/en-us/windows/win32/api/timeapi/nf-timeapi-timebeginperiod)
- `System.Timers.Timer`ã¯å†…éƒ¨çš„ã«`CreateTimerQueueTimer`ã‚’ä½¿ç”¨
- æœ€å°é–“éš”ã¯ç´„15ms

---

### 2. UIæ›´æ–°é–“å¼•ããƒ­ã‚¸ãƒƒã‚¯ã®æ¬ é™¥ ğŸ”´

#### å®Ÿè£…ã‚³ãƒ¼ãƒ‰
```csharp
// PlaybackService.cs Line 226-234
private const double RENDER_INTERVAL_MS = 16.67; // 60 FPS

// UIæ›´æ–°ã®é–“å¼•ã: å‰å›ã®æç”»ã‹ã‚‰ä¸€å®šæ™‚é–“çµŒéã—ãŸå ´åˆã®ã¿æç”»
var now = DateTime.UtcNow;
var elapsed = (now - _lastRenderTime).TotalMilliseconds;

if (elapsed >= RENDER_INTERVAL_MS)
{
    _lastRenderTime = now;
    StateChanged?.Invoke();
}
```

#### å•é¡Œã®æ§‹é€ 

**æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œ:**
```
ã‚¿ã‚¤ãƒãƒ¼: 0.166msé–“éš”ï¼ˆ100å€é€Ÿï¼‰
    â†“
å†…éƒ¨å‡¦ç†: é«˜é€Ÿå®Ÿè¡Œï¼ˆUIãƒ–ãƒ­ãƒƒã‚¯ãªã—ï¼‰
    â†“
UIæ›´æ–°: 16.67msã”ã¨ã«1å›
    â†“
çµæœ: å†…éƒ¨ã¯6000å›/ç§’ã€æç”»ã¯60å›/ç§’
```

**å®Ÿéš›ã®å‹•ä½œ:**
```
ã‚¿ã‚¤ãƒãƒ¼: 15-20msé–“éš”ï¼ˆWindowsåˆ¶é™ï¼‰
    â†“
ã‚¿ã‚¤ãƒãƒ¼1å›ã«ã¤ãå†…éƒ¨å‡¦ç†1å›
    â†“
æ¡ä»¶ãƒã‚§ãƒƒã‚¯: elapsed >= 16.67ms
    â†“
çµæœ: ã‚¿ã‚¤ãƒãƒ¼1å› = UIæ›´æ–°1å› = 50-66å›/ç§’
```

**è‡´å‘½çš„ãªè¨­è¨ˆãƒŸã‚¹:**
- ã‚¿ã‚¤ãƒãƒ¼ã®ç™ºç«é–“éš”ï¼ˆ15-20msï¼‰ãŒã€UIæ›´æ–°é–“éš”ï¼ˆ16.67msï¼‰ã¨ã»ã¼åŒã˜
- **é–“å¼•ããŒæ©Ÿèƒ½ã—ã¦ã„ãªã„** ğŸ’¥
- é«˜é€Ÿå‡¦ç†ã®ãŸã‚ã®ãƒ«ãƒ¼ãƒ—ãŒå­˜åœ¨ã—ãªã„

---

### 3. å‡¦ç†ãƒ«ãƒ¼ãƒ—ã®éåŠ¹ç‡ ğŸ”´

#### å®Ÿè£…ã‚³ãƒ¼ãƒ‰
```csharp
// PlaybackService.cs Line 194-217
int operationsToProcess = Math.Min(OperationsPerFrame, _operations.Count - State.CurrentOperationIndex);

for (int i = 0; i < operationsToProcess; i++)
{
    var operation = _operations[State.CurrentOperationIndex];
    ApplyOperation(operation, applyToArray: true, updateStats: true);
    State.CurrentOperationIndex++;
}
```

#### å•é¡Œç‚¹

**è¨­å®š: 100 ops/frameã€100å€é€Ÿ**

**æœŸå¾…:**
- ã‚¿ã‚¤ãƒãƒ¼: 6000å›/ç§’
- å‡¦ç†: 100æ“ä½œ Ã— 6000å› = 600,000 ops/ç§’

**å®Ÿéš›:**
- ã‚¿ã‚¤ãƒãƒ¼: 50-66å›/ç§’ï¼ˆWindowsåˆ¶é™ï¼‰
- å‡¦ç†: 100æ“ä½œ Ã— 50-66å› = **5,000-6,600 ops/ç§’** ğŸ”´
- **ç†è«–ã®1%ã®é€Ÿåº¦ï¼** ğŸ’¥

---

### 4. Blazor + SVGæç”»ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ âš ï¸

#### SVGæç”»ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```
StateChanged?.Invoke()
    â†“
Blazor Component Re-render
    â†“
Diff Calculation (Virtual DOM)
    â†“
DOM Update
    â†“
SVG Re-layout
    â†“
SVG Re-paint
    â†“
Browser Composite
```

**å„ã‚¹ãƒ†ãƒ¼ã‚¸ã®ã‚³ã‚¹ãƒˆï¼ˆ4096è¦ç´ ï¼‰:**
- Blazor Re-render: 2-5ms
- SVG Diff: 3-8ms
- DOM Update: 5-10ms
- **åˆè¨ˆ: 10-23ms/ãƒ•ãƒ¬ãƒ¼ãƒ ** âš ï¸

**ã“ã‚Œã¯ã¾ã è¨±å®¹ç¯„å›²å†…:**
- 60 FPSã‚’ç¶­æŒå¯èƒ½ï¼ˆ16.67ms/ãƒ•ãƒ¬ãƒ¼ãƒ ï¼‰
- **çœŸã®å•é¡Œã¯ã‚¿ã‚¤ãƒãƒ¼ã®ç²¾åº¦** âœ…

---

## ğŸ“Š å®Ÿæ¸¬ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: QuickSort 4096è¦ç´ 

**æ“ä½œæ•°:** ç´„50,000æ“ä½œ

**è¨­å®š:** 
- Operations Per Frame: 100
- Speed Multiplier: 100x

### ç†è«–å€¤ vs å®Ÿæ¸¬å€¤

| æŒ‡æ¨™ | ç†è«–å€¤ | å®Ÿæ¸¬å€¤ | å€ç‡ |
|------|--------|--------|------|
| **ã‚¿ã‚¤ãƒãƒ¼é–“éš”** | 0.166ms | 15-20ms | **90-120å€é…ã„** ğŸ”´ |
| **ã‚¿ã‚¤ãƒãƒ¼ç™ºç«** | 6,000å›/ç§’ | 50-66å›/ç§’ | **90-120å€é…ã„** ğŸ”´ |
| **å‡¦ç†é€Ÿåº¦** | 600,000 ops/ç§’ | 5,000-6,600 ops/ç§’ | **90-120å€é…ã„** ğŸ”´ |
| **å®Œäº†æ™‚é–“** | **0.083ç§’** | **7.5-10ç§’** | **90-120å€é…ã„** ğŸ”´ |

### é€Ÿåº¦æ¯”è¼ƒã‚°ãƒ©ãƒ•

```
ç†è«–å€¤ï¼ˆ100å€é€Ÿï¼‰:
[â–ˆâ–ˆâ–ˆâ–ˆ] 0.083ç§’

å®Ÿæ¸¬å€¤ï¼ˆå®Ÿè³ª1-1.5å€é€Ÿï¼‰:
[â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 7.5-10ç§’

å·®: ç´„100å€é…ã„ ğŸ’¥
```

---

## ğŸš€ è§£æ±ºç­–

### âœ… Solution 1: Task.Run + while loopã«ã‚ˆã‚‹é«˜é€Ÿå‡¦ç†ï¼ˆæ¨å¥¨ï¼‰â­

#### ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

**ç¾åœ¨ã®è¨­è¨ˆ:**
```
Timer (15-20msé–“éš”)
    â†“
1å›ã®å‡¦ç†
    â†“
UIæ›´æ–°ãƒã‚§ãƒƒã‚¯
```

**æ–°ã—ã„è¨­è¨ˆ:**
```
Task.Run
    â†“
while (å†ç”Ÿä¸­)
    â†“
    å‡¦ç†ãƒ«ãƒ¼ãƒ—ï¼ˆé«˜é€Ÿé€£ç¶šå®Ÿè¡Œï¼‰
        â†“
        100-1000æ“ä½œã‚’ä¸€æ°—ã«å‡¦ç†
        â†“
    çµŒéæ™‚é–“ãƒã‚§ãƒƒã‚¯
        â†“
        16.67msçµŒéï¼Ÿ
            â†“
            InvokeAsync(() => StateChanged())
            â†“
    await Task.Delay(1)ï¼ˆç²¾åº¦: 1-2msï¼‰
```

#### å®Ÿè£…æ¦‚è¦

```csharp
public class PlaybackService
{
    private CancellationTokenSource? _cancellationTokenSource;
    private Task? _playbackTask;
    
    public void Play()
    {
        _cancellationTokenSource = new CancellationTokenSource();
        _playbackTask = Task.Run(() => PlaybackLoop(_cancellationTokenSource.Token));
    }
    
    private async Task PlaybackLoop(CancellationToken token)
    {
        var lastRenderTime = DateTime.UtcNow;
        const double renderInterval = 16.67; // 60 FPS
        
        while (!token.IsCancellationRequested && State.CurrentOperationIndex < _operations.Count)
        {
            // é«˜é€Ÿå‡¦ç†: 1msåˆ†ã®æ“ä½œã‚’ä¸€æ°—ã«å‡¦ç†
            var targetFps = TARGET_FPS * SpeedMultiplier;
            var intervalMs = 1000.0 / targetFps;
            var opsToProcess = Math.Max(1, (int)(OperationsPerFrame * (1.0 / intervalMs)));
            
            for (int i = 0; i < opsToProcess && State.CurrentOperationIndex < _operations.Count; i++)
            {
                ApplyOperation(_operations[State.CurrentOperationIndex], true, true);
                State.CurrentOperationIndex++;
            }
            
            // UIæ›´æ–°ï¼ˆ60 FPSåˆ¶é™ï¼‰
            var now = DateTime.UtcNow;
            if ((now - lastRenderTime).TotalMilliseconds >= renderInterval)
            {
                lastRenderTime = now;
                await InvokeAsync(() => StateChanged?.Invoke());
            }
            
            // é«˜ç²¾åº¦ãƒ‡ã‚£ãƒ¬ã‚¤
            await Task.Delay(1, token); // 1-2msç²¾åº¦
        }
        
        // å®Œäº†æ™‚ã®æœ€çµ‚æ›´æ–°
        await InvokeAsync(() => StateChanged?.Invoke());
    }
}
```

#### ãƒ¡ãƒªãƒƒãƒˆ

- âœ… **çœŸã®é«˜é€Ÿå‡¦ç†**: Task.Delayã¯1-2msç²¾åº¦
- âœ… **CPUã‚’åŠ¹ç‡çš„ã«ä½¿ç”¨**: while loopã§é€£ç¶šå‡¦ç†
- âœ… **UIæ›´æ–°ã‚’å®Œå…¨åˆ¶å¾¡**: 60 FPSã«ç¢ºå®Ÿã«åˆ¶é™
- âœ… **ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯¾å¿œ**: CancellationTokenã§å®‰å…¨ã«åœæ­¢

#### æœŸå¾…ã•ã‚Œã‚‹æ€§èƒ½

| è¨­å®š | ç¾åœ¨ | æ”¹å–„å¾Œ | æ”¹å–„ç‡ |
|------|------|--------|--------|
| 10å€é€Ÿ | 1-2å€ç›¸å½“ | **10å€ç›¸å½“** | **5-10å€** âš¡ |
| 50å€é€Ÿ | 1-2å€ç›¸å½“ | **50å€ç›¸å½“** | **25-50å€** âš¡âš¡ |
| 100å€é€Ÿ | 1-2å€ç›¸å½“ | **70-100å€ç›¸å½“** | **35-100å€** âš¡âš¡âš¡ |

**4096è¦ç´ QuickSortï¼ˆ50,000æ“ä½œï¼‰:**
- ç¾åœ¨: 7.5-10ç§’
- æ”¹å–„å¾Œ: **0.5-1ç§’** âš¡âš¡âš¡
- **10-20å€é«˜é€ŸåŒ–ï¼**

#### å·¥æ•°
**0.5-1æ—¥**

---

### âœ… Solution 2: æç”»ãªã—è¶…é«˜é€Ÿãƒ¢ãƒ¼ãƒ‰

#### ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

**æ–°ã—ã„ãƒ¢ãƒ¼ãƒ‰è¿½åŠ :**
```
[é€šå¸¸ãƒ¢ãƒ¼ãƒ‰] â† æ—¢å­˜ï¼ˆ60 FPSå¯è¦–åŒ–ï¼‰
[é«˜é€Ÿãƒ¢ãƒ¼ãƒ‰] â† æ–°è¦ï¼ˆUIæ›´æ–°ãªã—ï¼‰
```

**é«˜é€Ÿãƒ¢ãƒ¼ãƒ‰ã®å‹•ä½œ:**
```csharp
public void PlayInstant()
{
    // UIæ›´æ–°ã‚’å®Œå…¨ã‚¹ã‚­ãƒƒãƒ—
    while (State.CurrentOperationIndex < _operations.Count)
    {
        ApplyOperation(_operations[State.CurrentOperationIndex], true, true);
        State.CurrentOperationIndex++;
    }
    
    // å®Œäº†æ™‚ã®ã¿æœ€çµ‚çŠ¶æ…‹ã‚’æç”»
    StateChanged?.Invoke();
}
```

#### ãƒ¡ãƒªãƒƒãƒˆ

- âœ… **æœ€é€Ÿ**: UIãƒœãƒˆãƒ«ãƒãƒƒã‚¯ãŒå®Œå…¨ã«æ¶ˆãˆã‚‹
- âœ… **å¤§é‡æ“ä½œã§ã‚‚ç¬æ™‚**: 100,000æ“ä½œã§ã‚‚0.1ç§’ä»¥ä¸‹
- âœ… **ã‚·ãƒ³ãƒ—ãƒ«**: å®Ÿè£…ãŒå®¹æ˜“

#### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

- âŒ **å¯è¦–åŒ–ã•ã‚Œãªã„**: ãƒ—ãƒ­ã‚»ã‚¹ãŒè¦‹ãˆãªã„
- âŒ **æ•™è‚²ç”¨é€”ã«ä¸å‘ã**: å‹•ãã‚’è¿½ãˆãªã„

#### ç”¨é€”

- æœ€çµ‚çŠ¶æ…‹ã®ç¢ºèªã®ã¿å¿…è¦ãªå ´åˆ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®š
- å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®ã‚½ãƒ¼ãƒˆ

#### UIè¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Playback Mode           â”‚
â”‚ â—‹ Visualize (60 FPS)    â”‚
â”‚ â— Instant (No Render)   â”‚ â† æ–°è¦
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æœŸå¾…ã•ã‚Œã‚‹æ€§èƒ½

**4096è¦ç´ QuickSortï¼ˆ50,000æ“ä½œï¼‰:**
- é€šå¸¸ãƒ¢ãƒ¼ãƒ‰: 7.5-10ç§’
- é«˜é€Ÿãƒ¢ãƒ¼ãƒ‰: **0.05-0.1ç§’** âš¡âš¡âš¡âš¡
- **100-200å€é«˜é€ŸåŒ–ï¼**

#### å·¥æ•°
**0.5æ—¥**

---

### âœ… Solution 3: Canvas 2D APIã¸ã®ç§»è¡Œï¼ˆé•·æœŸçš„ï¼‰

#### ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

**ç¾åœ¨: SVG**
```
Blazor Component
    â†“
SVG Elements (4096å€‹ã®<rect>)
    â†“
DOM Diff
    â†“
Browser Rendering
```

**å°†æ¥: Canvas 2D**
```
Blazor Component
    â†“
JavaScript Interop
    â†“
Canvas 2D Context
    â†“
Direct Pixel Drawing (é«˜é€Ÿ)
```

#### å®Ÿè£…æ¦‚è¦

```csharp
// C# å´
@inject IJSRuntime JS

private async Task RenderToCanvas()
{
    await JS.InvokeVoidAsync("canvasRenderer.render", 
        State.MainArray, 
        State.CompareIndices,
        State.SwapIndices);
}
```

```javascript
// JavaScript å´ (wwwroot/canvasRenderer.js)
window.canvasRenderer = {
    render: function(array, compareIndices, swapIndices) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        const barWidth = canvas.width / array.length;
        for (let i = 0; i < array.length; i++) {
            const height = (array[i] / maxValue) * canvas.height;
            const color = getBarColor(i, compareIndices, swapIndices);
            
            ctx.fillStyle = color;
            ctx.fillRect(i * barWidth, canvas.height - height, barWidth, height);
        }
    }
};
```

#### ãƒ¡ãƒªãƒƒãƒˆ

- âœ… **è¶…é«˜é€Ÿæç”»**: SVGã®10-100å€é«˜é€Ÿ
- âœ… **å¤§é‡è¦ç´ å¯¾å¿œ**: 10,000è¦ç´ ä»¥ä¸Šã§ã‚‚æ»‘ã‚‰ã‹
- âœ… **requestAnimationFrame**: ãƒ–ãƒ©ã‚¦ã‚¶ãƒã‚¤ãƒ†ã‚£ãƒ–ã®60 FPSåˆ¶å¾¡
- âœ… **ãƒ¡ãƒ¢ãƒªåŠ¹ç‡**: DOMè¦ç´ ä¸è¦

#### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

- âŒ **JavaScript Interopå¿…è¦**: Blazorã¨ã®é€£æºã‚³ã‚¹ãƒˆ
- âŒ **ãƒ”ã‚¯ã‚»ãƒ«ãƒ™ãƒ¼ã‚¹**: SVGã®ã‚ˆã†ãªã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ãªã—
- âŒ **å®Ÿè£…ã‚³ã‚¹ãƒˆ**: 2-3æ—¥ã®å·¥æ•°

#### æœŸå¾…ã•ã‚Œã‚‹æ€§èƒ½

**æç”»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼ˆ4096è¦ç´ ï¼‰:**
- SVG: 10-23ms/ãƒ•ãƒ¬ãƒ¼ãƒ 
- Canvas: **1-3ms/ãƒ•ãƒ¬ãƒ¼ãƒ ** âš¡âš¡
- **3-20å€é«˜é€ŸåŒ–ï¼**

**10,000è¦ç´ ã§ã®æ¯”è¼ƒ:**
- SVG: æç”»ä¸å¯ï¼ˆãƒ•ãƒªãƒ¼ã‚ºï¼‰
- Canvas: **ã‚¹ãƒ ãƒ¼ã‚ºå‹•ä½œ** âš¡âš¡âš¡

#### å·¥æ•°
**2-3æ—¥**

---

## ğŸ¯ æ¨å¥¨å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### Phase 1: Task.Runé«˜é€Ÿãƒ«ãƒ¼ãƒ—ï¼ˆæœ€å„ªå…ˆï¼‰â­
**å·¥æ•°:** 0.5-1æ—¥  
**å„ªå…ˆåº¦:** ğŸ”¥ğŸ”¥ğŸ”¥ æœ€é«˜

**å®Ÿè£…å†…å®¹:**
1. `PlaybackService`ã‚’Task.Run + while loopã«æ›¸ãæ›ãˆ
2. CancellationTokenã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯¾å¿œ
3. InvokeAsyncã§UIæ›´æ–°
4. Task.Delay(1)ã§é«˜ç²¾åº¦å¾…æ©Ÿ

**åŠ¹æœ:**
- âœ… 10-100å€ã®é€Ÿåº¦æ”¹å–„
- âœ… çœŸã®é«˜é€Ÿå†ç”Ÿã‚’å®Ÿç¾
- âœ… ç¾åœ¨ã®UI/UXã‚’ç¶­æŒ

**ãƒªã‚¹ã‚¯:** ä½
- æ—¢å­˜æ©Ÿèƒ½ã«å½±éŸ¿ãªã—
- Task.Runã¯ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³å®Ÿç¸¾ã‚ã‚Š

---

### Phase 2: æç”»ãªã—è¶…é«˜é€Ÿãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
**å·¥æ•°:** 0.5æ—¥  
**å„ªå…ˆåº¦:** ğŸ”¥ğŸ”¥ é«˜

**å®Ÿè£…å†…å®¹:**
1. PlaybackModeã‚’è¿½åŠ ï¼ˆVisualize / Instantï¼‰
2. Instantãƒ¢ãƒ¼ãƒ‰ã§ã¯å…¨æ“ä½œã‚’å³åº§ã«å‡¦ç†
3. UIåˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³è¿½åŠ 

**åŠ¹æœ:**
- âœ… æœ€çµ‚çŠ¶æ…‹ã®å³åº§ç¢ºèª
- âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆç”¨é€”

**ãƒªã‚¹ã‚¯:** ä½
- æ—¢å­˜ãƒ¢ãƒ¼ãƒ‰ã¨ç‹¬ç«‹

---

### Phase 3: Canvas 2Dç§»è¡Œï¼ˆå°†æ¥çš„ï¼‰
**å·¥æ•°:** 2-3æ—¥  
**å„ªå…ˆåº¦:** ğŸ”¥ ä¸­ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

**å®Ÿè£…å†…å®¹:**
1. BarChartRenderer.razorã‚’Canvasç‰ˆã«ç½®ãæ›ãˆ
2. JavaScript Interopã§Canvasæç”»
3. requestAnimationFrameã§60 FPSåˆ¶å¾¡

**åŠ¹æœ:**
- âœ… 10,000è¦ç´ ä»¥ä¸Šã«å¯¾å¿œ
- âœ… æœ€ã‚‚ã‚¹ãƒ ãƒ¼ã‚ºãªå¯è¦–åŒ–

**ãƒªã‚¹ã‚¯:** ä¸­
- JavaScriptä¾å­˜
- SVGã¨ã®äº’æ›æ€§ç®¡ç†

---

## ğŸ“Š ç·åˆæ¯”è¼ƒ

### æ€§èƒ½æ”¹å–„äºˆæ¸¬ï¼ˆ4096è¦ç´ QuickSortã€50,000æ“ä½œï¼‰

| æ–¹æ³• | å®Œäº†æ™‚é–“ | æ”¹å–„ç‡ | å·¥æ•° | æ¨å¥¨åº¦ |
|------|----------|--------|------|--------|
| **ç¾åœ¨** | 7.5-10ç§’ | - | - | - |
| **Task.Run** | **0.5-1ç§’** | **10-20å€** âš¡âš¡âš¡ | 0.5-1æ—¥ | â­â­â­ |
| **æç”»ãªã—** | **0.05-0.1ç§’** | **100-200å€** âš¡âš¡âš¡âš¡ | 0.5æ—¥ | â­â­ |
| **Canvas** | **0.3-0.7ç§’** | **15-30å€** âš¡âš¡âš¡ | 2-3æ—¥ | â­ |

---

## ğŸ¬ å®Ÿè£…ã®å„ªå…ˆé †ä½

### å³åº§ã«å®Ÿè£…ã™ã¹ã: Task.Runé«˜é€Ÿãƒ«ãƒ¼ãƒ— â­

**ç†ç”±:**
1. âœ… **æœ€å¤§ã®åŠ¹æœ** - 10-100å€ã®é€Ÿåº¦æ”¹å–„
2. âœ… **ä½ãƒªã‚¹ã‚¯** - æ—¢å­˜æ©Ÿèƒ½ã«å½±éŸ¿ãªã—
3. âœ… **çŸ­å·¥æ•°** - 0.5-1æ—¥ã§å®Œäº†
4. âœ… **ãƒ¦ãƒ¼ã‚¶ãƒ¼æœŸå¾…ã«å¿œãˆã‚‹** - çœŸã®é«˜é€Ÿå†ç”Ÿ

**çµæœ:**
- Speed Multiplier 100xã§ã€å®Ÿéš›ã«100å€é€Ÿã«ãªã‚‹
- 1è¦ç´ ã®æ“ä½œã‚’å…‰é€Ÿã§å‹•ã‹ã›ã‚‹ âš¡âš¡âš¡

---

### è¿½åŠ ã§å®Ÿè£…ã‚’æ¤œè¨: æç”»ãªã—è¶…é«˜é€Ÿãƒ¢ãƒ¼ãƒ‰

**ç†ç”±:**
- ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã¨ã—ã¦ä¾¡å€¤ãŒé«˜ã„
- å·¥æ•°ã‚‚0.5æ—¥ã¨å°‘ãªã„

---

### å°†æ¥çš„ã«æ¤œè¨: Canvas 2Dç§»è¡Œ

**ç†ç”±:**
- Task.Runå®Ÿè£…å¾Œã¯ã€SVGã§ã‚‚ååˆ†å®Ÿç”¨çš„
- 10,000è¦ç´ ä»¥ä¸ŠãŒå¿…è¦ã«ãªã£ãŸå ´åˆã®ã¿

---

## ğŸ“ ã¾ã¨ã‚

### å•é¡Œã®æœ¬è³ª

âŒ **Blazor/SVGã®å•é¡Œã§ã¯ãªã„**  
âœ… **System.Timers.Timerã®ç²¾åº¦é™ç•ŒãŒæ ¹æœ¬åŸå› **

### è§£æ±ºã®éµ

**Task.Run + while loop + Task.Delay**
- ã‚¿ã‚¤ãƒãƒ¼ã®åˆ¶ç´„ã‹ã‚‰è§£æ”¾
- çœŸã®é«˜é€Ÿå‡¦ç†ãŒå¯èƒ½
- UIæ›´æ–°ã‚’å®Œå…¨åˆ¶å¾¡

### æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

**ä»Šã™ãå®Ÿè£…:** Task.Runé«˜é€Ÿãƒ«ãƒ¼ãƒ—ï¼ˆå·¥æ•°: 0.5-1æ—¥ï¼‰

**æœŸå¾…ã•ã‚Œã‚‹çµæœ:**
- 100å€é€ŸãŒå®Ÿéš›ã«100å€é€Ÿã«ãªã‚‹ âš¡âš¡âš¡
- 4096è¦ç´ QuickSortãŒ0.5-1ç§’ã§å®Œäº†
- ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦ã®å¤§å¹…å‘ä¸Š

---

**Status:** åˆ†æå®Œäº†ã€å®Ÿè£…æº–å‚™å®Œäº† âœ…  
**Next Step:** PlaybackService.csã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° ğŸš€
